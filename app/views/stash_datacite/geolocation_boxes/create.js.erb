$('div.geolocation_boxes').replaceWith('<%= j render partial: "stash_datacite/geolocation_boxes/index", locals: { geolocation_boxes: @geolocation_boxes } %>')
var bounds = [[<%= @geolocation_box.sw_latitude %>, <%= @geolocation_box.sw_longitude %>], [ <%= @geolocation_box.ne_latitude %>, <%= @geolocation_box.ne_longitude %> ]];
// create an orange rectangle
var newRectangle = L.rectangle(bounds, {color: "#ff7800", weight: 1}).addTo(map);
// zoom the map to the rectangle bounds
map.fitBounds(bounds);
var popup = L.popup(), geocode;

function onMapClick(e) {
    popup
        .setLatLng(e.latlng)
        .openOn(map);
        geocode.reverse(e.latlng);
}

map.on('click', onMapClick);
geocode = MQ.geocode().on('success', function(e) {
    popup.setContent(geocode.describeLocation(e.result.best));
});