$('#geolocation_places').replaceWith('<%= j render partial: "stash_datacite/geolocation_places/index", locals: { geolocation_places: @geolocation_places } %>')
$(document).ready(function(){
  map.remove();
  map = L.map('map', {
    layers: MQ.mapLayer(),
  });
    var drawnItems = new L.FeatureGroup();
    map.addLayer(drawnItems);

    var drawControl = new L.Control.Draw({
        position: 'topright',
        draw: {
          polyline : false,
          polygon : false,
          circle : false,
        },
        edit: {
            featureGroup: drawnItems
        }
    });
    map.addControl(drawControl);

    map.on('draw:created', function (e) {
        var type = e.layerType,
            layer = e.layer;
        drawnItems.addLayer(layer);
    });
 var place = $('#geo_place').val();

  MQ.geocode().search(place)
     .on('success', function(e) {
         var best = e.result.best,
             latlng = best.latlng;

         map.setView(latlng, 12);

         L.marker([ latlng.lat, latlng.lng ])
             .addTo(map)
             .bindPopup( place )
             .openPopup()
         });

});