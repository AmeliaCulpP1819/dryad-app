// $('#not_uploaded_file_<%= @temp_id%>').replaceWith("<%= escape_javascript(render(partial: 'stash_engine/file_uploads/uploaded_file', object: @my_file)) %>");

$('#not_uploaded_file_<%= @temp_id%>').remove();

// determine visiblity of links
var show10 = $('#show_10_files').is(":visible");
var showAll = $('#show_all_files').is(":visible");

// redraw table
$('#validated_files').html("<%= escape_javascript(
          render partial: 'stash_engine/file_uploads/validated_files', locals: {resource: @resource}) %>");

// reset method lockout & add events to few/many rows again
setUploadMethodLockout('<%= @resource.upload_type %>');
addEventFewManyRows();

// set link states again to what they were for few/many files
tableStateRestorer(show10, showAll);

// these are the upload buttons for items with the remove link visible, so upload hasn't started
var to_upload_buttons = $('.js-unuploaded .js-remove_link:visible').closest('.js-unuploaded').find('.js-upload-it');
if(to_upload_buttons.length && uploadInProgress){
  to_upload_buttons.first().click();
}else if($('.js-upload-it').length < 1 && uploadInProgress){
  // all are done, so stop the upload process
  uploadInProgress = false;
  $('#cancel_all').hide();
  updateButtonLinkStates(); // for file upload method
  $('#upload_complete').show(0); //.delay(5000).fadeOut(1000)
}
