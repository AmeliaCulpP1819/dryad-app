#! /usr/bin/env ruby

require 'stash/harvester_app'

module Stash
  module HarvesterApp
    begin
      options = Options.new(ARGV)
      puts Options::VERSION if options.show_version
      puts Options::HELP if options.show_help
      unless options.do_exit
        Application.new(
          from_time: options.from_time,
          until_time: options.until_time,
          config_file: options.config_file
        ).start
      end
    rescue OptionParser::ParseError => e
      puts e.message
      puts Options::USAGE
    rescue => e
      puts e.message
    end
  end
end
